
options:
  machineType: N1_HIGHCPU_8
  env:
  - PROJECT_ID=${PROJECT_ID}
  - BATCH_DISPATCHER_IMAGE=us.gcr.io/${PROJECT_ID}/batch-dispatcher:${SHORT_SHA}
  - BASTION_IMAGE=us.gcr.io/${PROJECT_ID}/bastion
  - CLOUDSQL_PROXY_IMAGE=us.gcr.io/${PROJECT_ID}/cloudsql-proxy:workaround
  - CIS_IMAGE=us.gcr.io/${PROJECT_ID}/cis
  - SOURCECLEAR_IMAGE=us.gcr.io/${PROJECT_ID}/sourceclear
  - DD_DJANGO_IMAGE=us.gcr.io/${PROJECT_ID}/defectdojo-django
  - DD_NGINX_IMAGE=us.gcr.io/${PROJECT_ID}/defectdojo-nginx
  - DOCS_IMAGE=us.gcr.io/${PROJECT_ID}/docs:${SHORT_SHA}
  - CODEDX_IMAGE=us.gcr.io/${PROJECT_ID}/codedx
  - SDARQ_FRONTEND_IMAGE=us.gcr.io/${PROJECT_ID}/sdarq-frontend:${SHORT_SHA}
  - SDARQ_BACKEND_IMAGE=us.gcr.io/${PROJECT_ID}/sdarq-backend:${SHORT_SHA}
  - CARTOGRAPHY_IMAGE=us.gcr.io/${PROJECT_ID}/cartography
  - DNS_DOMAIN=dsp-appsec.broadinstitute.org
  - DNS_ZONE=dsp-appsec
  - TERRAFORM_BUCKET=${PROJECT_ID}-terraform
  - BROAD_INGRESS_CSP=broad-ingress
  - DISK_SNAPSHOT_POLICY=appsec-apps-disk-snapshot-policy
  - JOB_DISPATCHER_ROLE=job-dispatcher
  - GLOBAL_NAMESPACE=global
  - CIS_DATASET=cis
  - DOJO_NAMESPACE=defectdojo
  - DOJO_SERVICE=defectdojo
  - SDARQ_SERVICE_ACCOUNT=sdarq-sa
  - REGION=us-east1
  - ZONE_1=us-east1-b
  - ZONE_2=us-east1-c

- id: sourceclear
  name: gcr.io/cloud-builders/kubectl
  entrypoint: ./validate.sh
  dir: sourceclear